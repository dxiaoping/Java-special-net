create database java_knowledge_base;

use java_knowledge_base;

# 用户表
drop table `user`;
create table `user` (
  `phone` bigint(20) not null comment '手机号',
  `role` int(2) not null default 2 comment '用户角色',
  `name` varchar(20) default null comment '用户名',
  `password` varchar(20) not null default '123456' comment '用户密码',
  `security_question` varchar(100) default null comment '密保问题',
  `security_answer` varchar(100) default null comment '密保答案',
  `create_time` datetime DEFAULT NULL COMMENT '注册时间',
  primary key (phone)
) comment = '用户信息表';


alter table user
  add column `create_time` datetime DEFAULT NULL
COMMENT '注册时间';

alter table user
  change column securityAnswer security_answer varchar(100) default null
comment '密保答案';
alter table user
  change column securityQuestion security_question varchar(100) default null
comment '密保问题';

# 目录表
drop table menu;
create table `menu` (
  `id` bigint(20) not null comment '目录Id',
  `parent_id` bigint(20) not null comment '父目录Id',
  `name` varchar(20) not null comment '目录名称',
  primary key (id)
) comment = '目录表';

create table `content` (
  `id` bigint(20) not null comment '内容主体Id',
  `parent_id` bigint(20) not null comment '父目录Id',
  `user_id` bigint(20) not null comment '用户手机号，标识上传用户',
  `text` varchar(300) comment '文本信息',
  `img` varchar(30) comment '图片地址',
  `video` varchar(30) comment '视频地址',
  `code` varchar(3000) comment '源码',
  `createTime` varchar(3000) comment '创建时间',
  `updateTime` varchar(3000) comment '更新时间',
  primary key (id)
)
  comment = '内容窗体';

# 附件表
create table enclosures (
  `id` bigint(20) not null comment '附件Id',
  `parent_id` bigint(20) not null comment 'content对象Id',
  `name` varchar(30) not null comment '附件名称',
  `url` varchar(50) not null comment '附件地址',
  `create_time` datetime default null comment '创建时间',
  `userId` bigint(20) not null comment '上传用户',
  primary key (id)
) comment = '附件表';

alter table menu
  change column parent_id parent_id bigint(20) not null
comment '父目录Id';

# 一级目录限定在100~199以内
# 二级目录约定在1000~9999
# 三级目录约定在10000~99999
insert into menu (id, parent_id, name) VALUES (101, 0, '基础模块');
insert into menu (id, parent_id, name)VALUES (102, 0, '进阶模块');
insert into menu (id, parent_id, name)VALUES (103, 0, '实例教程');
insert into menu (id, parent_id, name)VALUES (104, 0, '拓展知识');
insert into menu (id, parent_id, name)VALUES (105, 0, '作品展示');
insert into menu (id, parent_id, name)VALUES (106, 0, '相关资源');

insert into menu (id, parent_id, name)VALUES (1001, 101, '数组');
insert into menu (id, parent_id, name)VALUES (1002, 101, '链表');

insert into user (phone, role, name, password)
VALUES (15574902295, 0, '小平', 'asdzxc');