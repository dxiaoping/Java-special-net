<!DOCTYPE html>
<html lang="en" xmlns:max-height="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Java资源库</title>
    <script type="text/javascript" src="/static/jquery/jquery-3.1.4.js"></script>
    <!--<script type="text/css" src="/static/css/menu.css"></script>-->
    <link rel="styleSheet" href="/static/css/menu.css" type="text/css">
</head>
<body style="display: flex;">
<div id="main_view" >
    <!--按钮悬浮事件、按钮点击事件-->
    <!--<button onclick="" onmouseover=""></button>-->
    <ul id="menu" style="width: 100px"></ul>
</div>
<div id="content_main" name="100001" class="jsn_content_style">

    <!--文本-->
    <iframe id="jsn_text" name="jsn_text" class="jsn_frame_style" style="display: none"></iframe>
    <!--视频框-->
    <iframe id="jsn_video" name="jsn_video" class="jsn_frame_style" style="display: none"></iframe>
    <!--图片框-->
    <iframe id="jsn_img" name="jsn_img" class="jsn_frame_style" style="display: none"></iframe>
    <!--代码栏-->
    <iframe id="jsn_code" name="jsn_code" class="jsn_frame_style" style="display: none"></iframe>
    <!--文件上传-->
    <input id="file" type="file" name="file"/>
    <!--上传按钮,点击后判断是否会覆盖之前文件，征求用户意见-->
    <button id="upload" onclick="upload()" class="button_style"/>
</div>


</body>
<script>
    function upload() {
        var formData = new FormData();
        formData.append("upload_file", $("#file")[0].files[0]);
        formData.append("id", $("#file").parent().attr("id"));
        $.ajax({
            url: "/content/upload",
            type: 'POST',
            data: formData,
            contentType: false,
            processData: false,//这个很有必要，不然不行
            dataType: "json",
            mimeType: "multipart/form-data",
            success: function (data) {
                console.log(data);
            },
            error: function () {
                alert("客户端请求有误")
            }
        });
    }

    function menu_over(id) {
        get_menu_list(id);
        $("#ul" + id).css('display', 'block');
    }

    function menu_out(id) {
        $("#ul"+id).css('display', 'none');
    }

    function get_menu_list(id) {
        $.ajax({
            url: "/menu/data",
            type: "GET",
            // 入参
            data: {
                // verifyCode:$("#verifyCode").val()
                menuId: id
            },
            success: function (data) {
                var list = data.data;
                var parent = document.getElementById(id);
                var ul = document.createElement("ul");
                parent.appendChild(ul);

                ul.setAttribute("id","ul"+id);
                for (var i = 0; i < list.length; i++) {
                    // 动态添加
                    if (document.getElementById(list[i].id)==null){
                        var li = document.createElement("li");
                        var a = document.createElement("a");
                        a.setAttribute("href","#");
                        li.appendChild(a);
                        li.setAttribute("id", list[i].id);
                        li.setAttribute("onclick","display_content("+list[i].id+")");
                        a.innerHTML=list[i].name;
                        ul.appendChild(li);
                    }
                }
                console.log(data);
            },
            error: function () {
                // layer.msg("客户端请求有误");
                alert("客户端请求有误");
            }
        });
    }

</script>
<script>
    function display_content(id){
        $.ajax({
            url: "/content/get_content",
            type: "POST",
            data: {
                contentId:id
                    // $("#content_main").attr("name")
                // contentId:100001
            },
            success: function (data) {
                var jsn_content = data.data;
                console.log(jsn_content);

                if (jsn_content.img != null && jsn_content.img != "") {
                    console.log(jsn_content.img);
                    display_frame("jsn_img",jsn_content.img);
                }
                if (jsn_content.code != null && jsn_content.code != "") {
                    console.log(jsn_content.code);
                    display_frame("jsn_code",jsn_content.code);
                }
                if (jsn_content.text != null && jsn_content.text != "") {
                    console.log(jsn_content.text);
                    display_frame("jsn_text",jsn_content.text);
                }
                if (jsn_content.video != null && jsn_content.video != "") {
                    console.log(jsn_content.video);
                    display_frame("jsn_video",jsn_content.video);
                }
                console.info(data);
            },
            error: function () {
                alert($("#content_main").attr("name"));
            }
        });
        function display_frame(frame_id,src_value){
            var frame = document.getElementById(frame_id);
            frame.setAttribute("src", src_value);
            $("#"+frame_id).css('display','block');
            frame.contentWindow.location.reload(true);
        }
    }
</script>
<script>

    $.ajax({
        url: "/menu/data",
        type: "GET",
        // 入参
        data: {
            // goodsId:goodsId,
            // verifyCode:$("#verifyCode").val()
            menuId: 0
        },
        success: function (data) {
            var list = data.data;
            var parent = document.getElementById("menu");
            for (var i = 0; i < list.length; i++) {
                //动态添加DIV
                var li = document.createElement("li");

                var a=document.createElement("a");
                a.setAttribute("href","https://www.baidu.com");
                li.appendChild(a);
                li.setAttribute("id", list[i].id);
                li.setAttribute("onmouseover","menu_over(id)");
                li.setAttribute("onmouseout","menu_out(id)");
                // li.innerHTML = list[i].name;
                a.innerHTML = list[i].name;
                parent.appendChild(li);
            }
            console.log(data);
        },
        error: function () {
            // layer.msg("客户端请求有误");
            alert("客户端请求有误")
        }
    });
</script>
</html>